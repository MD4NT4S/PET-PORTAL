import{c as D,u as C,r as g,j as e,B as m,T as E,M as F,I as A,t as R,L as j,a as P,U as I,R as T}from"./index-DwnMLDmv.js";import{C as v,a as N,b as w,c as k,d as S}from"./Card-DJu3BItJ.js";import{P as U}from"./plus-BTRbMjF8.js";const O=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],q=D("arrow-right",O);const _=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],M=D("image",_);function $(){const{photos:t,addPhoto:n,removePhoto:c,currentUser:l,userRole:a,isAdmin:y}=C(),[u,i]=g.useState(!1),[d,h]=g.useState(""),[b,p]=g.useState(""),[r,x]=g.useState(null),o=async s=>{if(s.preventDefault(),!d.trim()&&!r){R.error("Adicione uma URL ou selecione um arquivo");return}await n(d,b,r||void 0),h(""),p(""),x(null),i(!1)},z=s=>l?y?!0:l===s:!1;return e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-secondary-900 dark:text-white",children:"Mural do PET"}),e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Um espaço para compartilharmos nossos momentos."})]}),l&&e.jsxs(m,{onClick:()=>i(!0),className:"bg-primary-600 hover:bg-primary-700",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Adicionar Foto"]})]}),e.jsxs("div",{className:"relative bg-stone-200 dark:bg-stone-900 p-8 rounded-xl shadow-inner border-8 border-stone-300 dark:border-stone-800 min-h-[500px]",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#000 1px, transparent 1px)",backgroundSize:"20px 20px"}}),t.length===0?e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center h-full min-h-[300px] text-stone-500",children:[e.jsx(M,{className:"h-16 w-16 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"O mural está vazio."}),e.jsx("p",{className:"text-sm",children:"Adicione a primeira foto para começar a coleção!"})]}):e.jsx("div",{className:"relative z-10 flex flex-wrap justify-center content-start gap-4 pb-20",children:t.map((s,L)=>e.jsxs("div",{className:"group relative w-36 bg-white p-2 shadow-md hover:shadow-xl transition-all duration-300 ease-out hover:z-50 hover:scale-110",style:{transform:`rotate(${s.rotation}deg)`,marginTop:L%2===0?"0px":"20px",marginLeft:"-15px",marginRight:"-15px"},children:[e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-3 bg-yellow-100/80 shadow-sm transform -rotate-2"}),e.jsx("div",{className:"aspect-square w-full overflow-hidden mb-2 bg-stone-100",children:e.jsx("img",{src:s.url,alt:s.description||"Foto do mural",className:"h-full w-full object-cover pointer-events-none select-none",onError:f=>{f.target.src="https://via.placeholder.com/400x400?text=Erro+na+Imagem"}})}),e.jsxs("div",{className:"px-1",children:[e.jsx("p",{className:"font-handwriting text-xs text-stone-800 truncate font-bold text-center mb-1",children:s.description||""}),e.jsx("p",{className:"text-[10px] text-stone-400 text-center",children:new Date(s.createdAt).toLocaleDateString()})]}),z(s.author)&&e.jsx("button",{onClick:f=>{f.stopPropagation(),confirm("Remover esta foto?")&&c(s.id)},className:"absolute -top-2 -right-2 bg-red-500 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-sm hover:bg-red-600 z-50 cursor-pointer",title:"Remover foto",children:e.jsx(E,{className:"h-3 w-3"})})]},s.id))})]}),e.jsx(F,{isOpen:u,onClose:()=>i(!1),title:"Adicionar ao Mural",children:e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Foto"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"border-2 border-dashed border-secondary-300 rounded-lg p-4 text-center hover:bg-secondary-50 transition-colors cursor-pointer relative",children:[e.jsx("input",{type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:s=>{s.target.files&&s.target.files[0]&&(x(s.target.files[0]),h(""))}}),r?e.jsx("p",{className:"text-primary-600 font-medium truncate",children:r.name}):e.jsxs("div",{className:"flex flex-col items-center text-secondary-500",children:[e.jsx(M,{className:"h-6 w-6 mb-1"}),e.jsx("span",{className:"text-sm",children:"Clique para enviar um arquivo"})]})]}),e.jsxs("div",{className:"relative flex py-1 items-center",children:[e.jsx("div",{className:"flex-grow border-t border-secondary-300"}),e.jsx("span",{className:"flex-shrink-0 mx-4 text-secondary-400 text-xs",children:"OU"}),e.jsx("div",{className:"flex-grow border-t border-secondary-300"})]}),e.jsx(A,{placeholder:"Cole a URL da imagem...",value:d,onChange:s=>{h(s.target.value),x(null)},disabled:!!r,className:"bg-secondary-50 dark:bg-secondary-900"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Legenda (Opcional)"}),e.jsx(A,{placeholder:"Descreva o momento...",value:b,onChange:s=>p(s.target.value),maxLength:50})]}),e.jsxs("div",{className:"pt-2 flex justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"ghost",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(m,{type:"submit",disabled:!d&&!r,children:"Postar Foto"})]})]})})]})}function V(){const{tickets:t,evaluations:n,siteConfig:c,loadingConfig:l,currentUser:a}=C(),y=t.filter(o=>o.author===a&&o.status!=="Concluído"),u=n.filter(o=>o.author===a),i=new Date,d=i.getMonth(),h=i.getFullYear(),p=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][d],r=u.some(o=>o.criteria?.month===p&&new Date(o.createdAt).getFullYear()===h),x=r?100:0;return l?e.jsx("div",{className:"flex h-[50vh] items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary-600 border-t-transparent"})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("section",{className:"relative overflow-hidden rounded-2xl bg-primary-600 px-6 py-12 text-white shadow-xl sm:px-12 sm:py-16 md:px-16 lg:py-20",children:[e.jsxs("div",{className:"relative z-10 max-w-2xl space-y-4",children:[e.jsx("h1",{className:"text-4xl font-extrabold tracking-tight sm:text-5xl",children:c.heroTitle}),e.jsx("div",{className:"text-lg text-primary-100 max-w-xl",dangerouslySetInnerHTML:{__html:c.heroDescription}}),e.jsxs("div",{className:"flex flex-wrap gap-4 pt-4",children:[e.jsx(j,{to:"/autoavaliacao",children:e.jsxs(m,{size:"lg",className:"bg-white text-primary-600 hover:bg-primary-50",children:["Fazer Autoavaliação",e.jsx(q,{className:"ml-2 h-4 w-4"})]})}),e.jsx(j,{to:"/ouvidoria",children:e.jsx(m,{variant:"outline",size:"lg",className:"border-white text-white hover:bg-primary-700 hover:text-white",children:"Ouvidoria"})})]})]}),e.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 mr-8 opacity-20 transform rotate-12 pointer-events-none",children:e.jsx("img",{src:"/logo-white.png",alt:"PET Logo",className:"w-80 h-80 md:w-96 md:h-96 object-contain"})})]}),e.jsx($,{}),e.jsx(B,{}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(w,{children:"Acesso Rápido"})}),e.jsxs(k,{className:"grid grid-cols-2 gap-4",children:[e.jsxs(j,{to:"/ouvidoria",className:"flex flex-col items-center justify-center p-4 rounded-lg bg-secondary-50 hover:bg-secondary-100 dark:bg-secondary-900 dark:hover:bg-secondary-800 transition-colors border border-secondary-200 dark:border-secondary-800",children:[e.jsx(P,{className:"h-6 w-6 mb-2 text-primary-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Nova Manifestação"})]}),e.jsxs(j,{to:"/autoavaliacao",className:"flex flex-col items-center justify-center p-4 rounded-lg bg-secondary-50 hover:bg-secondary-100 dark:bg-secondary-900 dark:hover:bg-secondary-800 transition-colors border border-secondary-200 dark:border-secondary-800",children:[e.jsx(I,{className:"h-6 w-6 mb-2 text-primary-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Autoavaliação"})]})]})]}),e.jsxs(v,{children:[e.jsxs(N,{children:[e.jsxs(w,{children:["Status do Ciclo (",p,")"]}),e.jsx(S,{children:"Resumo das suas atividades."})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-secondary-600 dark:text-secondary-400",children:"Tickets Abertos"}),e.jsx("span",{className:"font-bold",children:y.length})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-secondary-600 dark:text-secondary-400",children:"Avaliações Enviadas"}),e.jsx("span",{className:"font-bold",children:u.length})]}),e.jsx("div",{className:"w-full bg-secondary-200 rounded-full h-2.5 dark:bg-secondary-700 mt-4",children:e.jsx("div",{className:`h-2.5 rounded-full transition-all duration-1000 ${x===100?"bg-green-500":"bg-primary-600"}`,style:{width:`${x}%`}})}),e.jsx("p",{className:"text-xs text-secondary-500 text-right",children:r?"Autoavaliação enviada!":"Autoavaliação pendente"})]})]})]})]})}function B(){const{notices:t}=C(),[n,c]=T.useState(!1);if(t.length===0)return null;const l=n?t:t.slice(0,3);return e.jsxs(v,{className:"border-l-4 border-l-primary-500",children:[e.jsxs(N,{className:"pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-primary-600"}),"Mural de Avisos"]}),t.length>3&&e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>c(!n),children:n?"Ver menos":"Ver todos"})]}),e.jsx(S,{children:"Fique por dentro das novidades do grupo."})]}),e.jsx(k,{className:"space-y-4",children:l.map(a=>e.jsxs("div",{className:"p-4 rounded-lg bg-secondary-50 dark:bg-secondary-900 border border-secondary-100 dark:border-secondary-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("h4",{className:"font-semibold text-secondary-900 dark:text-secondary-100 flex items-center gap-2",children:[a.type==="alert"&&e.jsx("span",{className:"text-red-500 text-xs px-1.5 py-0.5 bg-red-100 dark:bg-red-900/30 rounded",children:"Importante"}),a.type==="event"&&e.jsx("span",{className:"text-blue-500 text-xs px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900/30 rounded",children:"Evento"}),a.title]}),e.jsx("span",{className:"text-xs text-secondary-500 whitespace-nowrap ml-2",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-300 whitespace-pre-wrap",children:a.content}),e.jsxs("p",{className:"text-xs text-secondary-400 mt-2",children:["Postado por: ",a.author]})]},a.id))})]})}export{V as default};
